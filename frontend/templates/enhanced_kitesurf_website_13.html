<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>VARUN.SURF</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3e%3cdefs%3e%3clinearGradient id='ocean' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3e%3cstop offset='0%25' style='stop-color:%231e40af;stop-opacity:1' /%3e%3cstop offset='50%25' style='stop-color:%234a9eff;stop-opacity:1' /%3e%3cstop offset='100%25' style='stop-color:%2306b6d4;stop-opacity:1' /%3e%3c/linearGradient%3e%3clinearGradient id='wave' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3e%3cstop offset='0%25' style='stop-color:%23ffffff;stop-opacity:0.9' /%3e%3cstop offset='100%25' style='stop-color:%23f0f9ff;stop-opacity:0.7' /%3e%3c/linearGradient%3e%3c/defs%3e%3crect width='100' height='100' rx='20' fill='url(%23ocean)'/%3e%3cpath d='M0 60 Q15 45 30 60 T60 55 T90 60 T120 55 L120 100 L0 100 Z' fill='url(%23wave)' opacity='0.8'/%3e%3cpath d='M0 70 Q20 55 40 70 T80 65 T120 70 L120 100 L0 100 Z' fill='url(%23wave)' opacity='0.6'/%3e%3cpath d='M0 80 Q25 65 50 80 T100 75 T150 80 L150 100 L0 100 Z' fill='url(%23wave)' opacity='0.4'/%3e%3ccircle cx='75' cy='25' r='8' fill='%23fbbf24' opacity='0.9'/%3e%3cpath d='M70 30 Q75 35 80 30' fill='none' stroke='%23fbbf24' stroke-width='1' opacity='0.6'/%3e%3cpath d='M10 40 Q15 35 20 40 Q25 45 30 40' fill='none' stroke='%23ffffff' stroke-width='1.5' opacity='0.5'/%3e%3cpath d='M40 35 Q45 30 50 35 Q55 40 60 35' fill='none' stroke='%23ffffff' stroke-width='1.5' opacity='0.5'/%3e%3c/svg%3e">
    <style>
        :root {
            /* Dark theme variables */
            --bg-primary: #0f0f0f;
            --bg-secondary: #1a1a1a;
            --bg-tertiary: #262626;
            --text-primary: #e8e8e8;
            --text-secondary: #9ca3af;
            --text-tertiary: #5e6165;
            --border-primary: #262626;
            --border-secondary: #333;
            --border-hover: #404040;
            --accent-primary: #4a9eff;
            --accent-secondary: #216ebb;
            --gradient-button: linear-gradient(145deg, #1d1d1d, #2c2c2c);
            --gradient-button-hover: linear-gradient(145deg, #2c2c2c, #3d3d3d);
            --gradient-active: linear-gradient(145deg, #00397b, #1663b0);
            --gradient-header: linear-gradient(145deg, #0854ab, #216ebb);
            --shadow-card: 0 8px 32px rgba(0,0,0,.6);
            --error-bg: linear-gradient(145deg, #4b0404, #550303);
            --error-border: #840808;
            --error-text: #fca5a5;
            --success-color: #22c55e;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
        }

        [data-theme="light"] {
            /* Light theme variables */
            --bg-primary: #ffffff;
            --bg-secondary: #f8f9fa;
            --bg-tertiary: #e9ecef;
            --text-primary: #212529;
            --text-secondary: #6c757d;
            --text-tertiary: #adb5bd;
            --border-primary: #dee2e6;
            --border-secondary: #ced4da;
            --border-hover: #adb5bd;
            --accent-primary: #0d6efd;
            --accent-secondary: #0a58ca;
            --gradient-button: linear-gradient(145deg, #f8f9fa, #e9ecef);
            --gradient-button-hover: linear-gradient(145deg, #e9ecef, #dee2e6);
            --gradient-active: linear-gradient(145deg, #0d6efd, #0a58ca);
            --gradient-header: linear-gradient(145deg, #0d6efd, #0a58ca);
            --shadow-card: 0 8px 32px rgba(0,0,0,.1);
            --error-bg: linear-gradient(145deg, #f8d7da, #f5c6cb);
            --error-border: #f1aeb5;
            --error-text: #721c24;
            --success-color: #198754;
            --warning-color: #fd7e14;
            --danger-color: #dc3545;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Inter, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        /* FIXED HEADER STYLES */
        .fixed-header {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            right: 0 !important;
            width: 100% !important;
            z-index: 9999 !important;
            background: rgba(15, 15, 15, 0.7) !important;
            backdrop-filter: blur(5px) saturate(180%) !important;
            -webkit-backdrop-filter: blur(5px) saturate(180%) !important;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2) !important;
            padding: 20px !important;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4) !important;
        }

        [data-theme="light"] .fixed-header {
            background: rgba(255, 255, 255, 0.7) !important;
            border-bottom: 1px solid rgba(0, 0, 0, 0.2) !important;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15) !important;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            position: relative;
            display: flex;
            flex-direction: column;
            text-align: left;
        }

        .header-controls {
            position: absolute;
            top: 0;
            right: 0;
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .main-content {
            margin-top: 120px;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header-title {
            font-size: 2.8rem;
            font-weight: 100;
            color: #fff;
            margin-bottom: 8px;
            letter-spacing: -.02em;
            text-align: left;
        }

        [data-theme="light"] .header-title {
            color: #000;
        }

        .theme-toggle {
            background: var(--gradient-button);
            border: 1px solid var(--border-secondary);
            color: var(--text-primary);
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 120px;
            justify-content: center;
        }

        .theme-toggle:hover {
            background: var(--gradient-button-hover);
            border-color: var(--border-hover);
        }

        .theme-icon {
            font-size: 1rem;
            transition: transform 0.3s ease;
        }

        .dropdown-container {
            position: relative;
            width: 180px;
        }

        .dropdown-button {
            background: var(--gradient-button);
            border: 1px solid var(--border-secondary);
            color: #e0e0e0;
            padding: 8px 32px 8px 12px;
            border-radius: 12px;
            cursor: pointer;
            font-size: .9rem;
            font-weight: 500;
            width: 180px;
            text-align: left;
            transition: all .3s ease;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        [data-theme="light"] .dropdown-button {
            color: #212529;
        }

        .dropdown-button:hover {
            background: var(--gradient-button-hover);
            border-color: var(--border-hover);
        }

        .dropdown-button.active {
            background: var(--gradient-active);
            border-color: var(--accent-primary);
            color: #fff;
            box-shadow: 0 4px 12px rgba(74,158,255,.4);
        }

        .dropdown-arrow {
            font-size: .8rem;
            transition: transform .3s ease;
            color: #9ca3af;
        }

        [data-theme="light"] .dropdown-arrow {
            color: #6c757d;
        }

        .dropdown-button.active .dropdown-arrow {
            color: #fff;
        }

        .dropdown-button.open .dropdown-arrow {
            transform: rotate(180deg);
        }

        .dropdown-menu {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--bg-secondary);
            border: 1px solid var(--border-secondary);
            border-radius: 12px;
            margin-top: 4px;
            z-index: 100;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all .3s ease;
            box-shadow: var(--shadow-card);
            backdrop-filter: blur(10px);
            max-height: 300px;
            overflow-y: auto;
        }

        .dropdown-menu.open {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .dropdown-option {
            padding: 12px 16px;
            cursor: pointer;
            transition: all .2s ease;
            border-bottom: 1px solid var(--border-primary);
            font-size: .9rem;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #e8e8e8;
        }

        [data-theme="light"] .dropdown-option {
            color: #212529;
        }

        .dropdown-option:last-child {
            border-bottom: none;
        }

        .dropdown-option:hover {
            background: var(--bg-tertiary);
            color: #fff;
        }

        [data-theme="light"] .dropdown-option:hover {
            color: #000;
        }

        .dropdown-option.selected {
            background: var(--gradient-active);
            color: #fff;
        }

        .dropdown-option:first-child {
            border-radius: 11px 11px 0 0;
        }

        .dropdown-option:last-child {
            border-radius: 0 0 11px 11px;
        }

        .error-message {
            background: var(--error-bg);
            border: 1px solid var(--error-border);
            border-radius: 12px;
            padding: 24px;
            margin: 20px 0;
            text-align: center;
            box-shadow: 0 4px 12px rgba(220,38,38,.2);
        }

        .error-icon {
            font-size: 2rem;
            margin-bottom: 12px;
            display: block;
        }

        .error-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #fff;
            margin-bottom: 8px;
        }

        [data-theme="light"] .error-title {
            color: #721c24;
        }

        .error-description {
            color: var(--error-text);
            font-size: .9rem;
            margin-bottom: 16px;
            line-height: 1.5;
        }

        .loading-message {
            background: var(--bg-secondary);
            border: 1px solid var(--border-primary);
            border-radius: 12px;
            padding: 24px;
            margin: 20px 0;
            text-align: center;
        }

        .loading-spinner {
            display: inline-block;
            width: 24px;
            height: 24px;
            border: 3px solid var(--border-primary);
            border-top: 3px solid var(--accent-primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 12px;
            vertical-align: middle;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            color: #9ca3af;
            font-size: 1rem;
            vertical-align: middle;
        }

        [data-theme="light"] .loading-text {
            color: #6c757d;
        }

        .spots-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(600px, 1fr));
            gap: 30px;
        }

        .spot-card {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 24px;
            box-shadow: none;
            border: 1px solid var(--border-primary);
            transition: border-color .2s ease;
        }

        .spot-card:hover {
            transform: none;
            box-shadow: none;
            border-color: var(--border-secondary);
        }

        .spot-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border-primary);
        }

        .spot-title {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .spot-meta {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 8px;
        }

        .spot-name {
            font-size: 1.25rem;
            font-weight: 600;
            color: #fff;
        }

        [data-theme="light"] .spot-name {
            color: #000;
        }

        .last-updated {
            font-size: .75rem;
            color: #5e6165;
            font-weight: 400;
        }

        [data-theme="light"] .last-updated {
            color: #adb5bd;
        }

        .country-tag {
            background: var(--bg-tertiary);
            padding: 4px 10px;
            border-radius: 6px;
            font-size: .75rem;
            color: #9ca3af;
            border: none;
            font-weight: 500;
        }

        [data-theme="light"] .country-tag {
            color: #6c757d;
        }

        .external-links {
            display: flex;
            gap: 8px;
            margin-top: 16px;
            flex-wrap: wrap;
        }

        .external-link {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            background: transparent;
            color: #9ca3af;
            text-decoration: none;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: .75rem;
            font-weight: 500;
            border: 1px solid var(--border-secondary);
            transition: all .15s ease;
            cursor: pointer;
        }

        [data-theme="light"] .external-link {
            color: #6c757d;
        }

        .external-link:hover {
            background: var(--bg-tertiary);
            color: #fff;
            border-color: var(--border-hover);
        }

        [data-theme="light"] .external-link:hover {
            color: #000;
        }

        .external-link::after {
            content: "↗";
            font-size: .7rem;
            opacity: .6;
        }

        .external-link.location-link::after {
            content: "⚲";
            font-size: .8rem;
            opacity: 1;
        }

        .external-link.webcam-link::after {
            content: "⊙";
            font-size: .8rem;
            opacity: 1;
        }

        .external-link.ai-link {
            border: 1px solid #1f7987;
        }

        .external-link.ai-link::after {
            content: "⟡";
            font-size: .8rem;
            opacity: 1;
        }

        .external-link.info-link::after {
            content: "ⓘ";
            font-size: .8rem;
            opacity: 1;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,.8);
            backdrop-filter: blur(4px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            animation: fadeIn .3s ease;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: var(--bg-secondary);
            border: 1px solid var(--border-secondary);
            border-radius: 16px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0,0,0,.5);
            animation: modalSlideIn .3s ease;
        }

        .modal-header {
            background: var(--gradient-header);
            padding: 20px 24px;
            border-bottom: 1px solid var(--border-secondary);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            color: #fff;
            font-size: 1.2rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .modal-close {
            background: transparent;
            border: none;
            color: #fff;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: background .2s ease;
        }

        .modal-close:hover {
            background: rgba(255,255,255,.1);
        }

        .modal-content {
            padding: 24px;
            overflow-y: auto;
            max-height: calc(80vh - 80px);
        }

        .ai-analysis {
            color: #e8e8e8;
            line-height: 1.6;
            font-size: .95rem;
        }

        [data-theme="light"] .ai-analysis {
            color: #212529;
        }

        .ai-analysis h3 {
            color: #4a9eff;
            margin-bottom: 12px;
            font-size: 1.1rem;
            font-weight: 600;
        }

        [data-theme="light"] .ai-analysis h3 {
            color: #0d6efd;
        }

        .ai-analysis p {
            margin-bottom: 16px;
        }

        .ai-analysis ul {
            margin-left: 20px;
            margin-bottom: 16px;
        }

        .ai-analysis li {
            margin-bottom: 8px;
        }

        .ai-highlight {
            background: rgba(74,158,255,.1);
            color: #4a9eff;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 500;
        }

        [data-theme="light"] .ai-highlight {
            color: #0d6efd;
        }

        .spot-info {
            color: #e8e8e8;
            line-height: 1.6;
            font-size: .95rem;
        }

        [data-theme="light"] .spot-info {
            color: #212529;
        }

        .spot-info h3 {
            color: #4a9eff;
            margin-bottom: 12px;
            font-size: 1.1rem;
            font-weight: 600;
        }

        [data-theme="light"] .spot-info h3 {
            color: #0d6efd;
        }

        .spot-info p {
            margin-bottom: 16px;
        }

        .spot-info .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin: 16px 0;
        }

        .info-item {
            background: var(--bg-tertiary);
            padding: 12px 16px;
            border-radius: 8px;
            border: 1px solid var(--border-primary);
        }

        .info-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-bottom: 4px;
            font-weight: 500;
        }

        .info-value {
            font-weight: 600;
            color: var(--text-primary);
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-20px) scale(.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .weather-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            border-radius: 8px;
            overflow: hidden;
        }

        .weather-table th {
            background: var(--bg-tertiary);
            color: #fff;
            padding: 12px 8px;
            text-align: center;
            font-weight: 600;
            border-bottom: none;
            font-size: .8rem;
            text-transform: uppercase;
            letter-spacing: .05em;
        }

        [data-theme="light"] .weather-table th {
            color: #000;
        }

        .weather-table th:first-child {
            text-align: left;
        }

        .weather-table td {
            padding: 12px 8px;
            text-align: center;
            border-bottom: 1px solid var(--border-primary);
            font-size: .875rem;
            color: #e8e8e8;
        }

        [data-theme="light"] .weather-table td {
            color: #212529;
        }

        .weather-table td:first-child {
            text-align: left;
        }

        .weather-table tbody tr.weak-wind td:nth-child(2),
        .weather-table tbody tr.weak-wind td:nth-child(3),
        .weather-table tbody tr.weak-wind td:nth-child(4) {
            color: #6b7280 !important;
        }

        .weather-table tbody tr.moderate-wind td:nth-child(2),
        .weather-table tbody tr.moderate-wind td:nth-child(3),
        .weather-table tbody tr.moderate-wind td:nth-child(4) {
            color: #22c55e !important;
        }

        .weather-table tbody tr.strong-wind td:nth-child(2),
        .weather-table tbody tr.strong-wind td:nth-child(3),
        .weather-table tbody tr.strong-wind td:nth-child(4) {
            color: #f59e0b !important;
        }

        .weather-table tbody tr.extreme-wind td:nth-child(2),
        .weather-table tbody tr.extreme-wind td:nth-child(3),
        .weather-table tbody tr.extreme-wind td:nth-child(4) {
            color: #ef4444 !important;
        }

        .weather-table tbody td.wind-weak {
            color: #6b7280 !important;
        }

        .weather-table tbody td.wind-moderate {
            color: #22c55e !important;
            font-weight: 600;
        }

        .weather-table tbody td.wind-strong {
            color: #f59e0b !important;
            font-weight: 600;
        }

        .weather-table tbody td.wind-extreme {
            color: #ef4444 !important;
            font-weight: 600;
        }

        .weather-table tbody td.temp-positive {
            color: #f97316 !important;
        }

        .weather-table tbody td.temp-negative {
            color: #06b6d4 !important;
        }

        .weather-table tbody td.precipitation {
            color: #3b82f6 !important;
        }

        .weather-table tbody td.precipitation-none {
            color: #6b7280 !important;
        }

        .weather-table tbody td.wave-small {
            color: #22c55e !important;
        }

        .weather-table tbody td.wave-moderate {
            color: #f59e0b !important;
            font-weight: 600;
        }

        .weather-table tbody td.wave-large {
            color: #ef4444 !important;
            font-weight: 600;
        }

        .weather-table tr.weak-wind {
            background: transparent;
            color: var(--text-secondary);
        }

        .weather-table tr.moderate-wind {
            background: rgba(34,197,94,.1);
            color: var(--success-color);
        }

        .weather-table tr.strong-wind {
            background: rgba(245,158,11,.1);
            color: var(--warning-color);
        }

        .weather-table tr.extreme-wind {
            background: rgba(239,68,68,.1);
            color: var(--danger-color);
        }

        .wind-arrow {
            display: inline-block;
            font-size: 1.2rem;
            transition: transform .3s ease;
        }

        .live-indicator {
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .live-dot {
            width: 8px;
            height: 8px;
            background: var(--success-color);
            border-radius: 50%;
            position: relative;
            animation: pulse-glow 2s ease-in-out infinite;
            margin-left: 8px;
        }

        .live-dot::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: var(--success-color);
            border-radius: 50%;
            opacity: .4;
            animation: pulse-ring 2s ease-in-out infinite;
        }

        @keyframes pulse-glow {
            0%, 100% {
                opacity: 1;
                transform: scale(1);
            }
            50% {
                opacity: .8;
                transform: scale(1.1);
            }
        }

        @keyframes pulse-ring {
            0% {
                transform: scale(1);
                opacity: .4;
            }
            50% {
                transform: scale(1.5);
                opacity: .2;
            }
            100% {
                transform: scale(2);
                opacity: 0;
            }
        }

        @media (max-width: 980px) {
            .spots-grid {
                grid-template-columns: 1fr;
            }

            .weather-table {
                font-size: .85rem;
            }

            .weather-table td, .weather-table th {
                padding: 8px 4px;
            }

            .error-message {
                padding: 20px;
            }

            .error-title {
                font-size: 1.1rem;
            }

            .error-description {
                font-size: .85rem;
            }

            .fixed-header {
                padding: 15px 20px !important;
            }

            .header-content {
                text-align: center;
            }

            .header-title {
                text-align: center;
                margin-top: 0px;
                font-size: 2.2rem;
            }

            .header-controls {
                position: static;
                flex-direction: row;
                align-items: center;
                gap: 12px;
                margin-bottom: 15px;
                width: 100%;
                justify-content: center;
            }

            .theme-toggle {
                width: auto;
                max-width: none;
                min-width: 80px;
            }

            .dropdown-container {
                width: auto;
                max-width: none;
                min-width: 120px;
            }

            .main-content {
                margin-top: 170px;
            }

            .info-grid {
                grid-template-columns: 1fr !important;
            }
        }

        .footer {
            margin-top: 60px;
            padding: 30px 0;
            border-top: 1px solid var(--border-primary);
            text-align: center;
        }

        .footer-content {
            max-width: 600px;
            margin: 0 auto;
        }

        .footer-content p {
            color: #9ca3af;
            font-size: .875rem;
            margin-bottom: 8px;
        }

        [data-theme="light"] .footer-content p {
            color: #6c757d;
        }

        .footer-content p:last-child {
            margin-bottom: 0;
        }

        .footer-disclaimer {
            font-size: .75rem;
            opacity: .8;
        }

        .footer-link {
            font-size: .75rem;
            margin-top: 12px;
        }

        .footer-disclaimer a, .footer-link a {
            color: #4a9eff;
            text-decoration: none;
            transition: color .2s ease;
        }

        .footer-disclaimer a:hover, .footer-link a:hover {
            color: #fff;
            text-decoration: underline;
        }

        [data-theme="light"] .footer-disclaimer a, [data-theme="light"] .footer-link a {
            color: #0d6efd;
        }

        [data-theme="light"] .footer-disclaimer a:hover, [data-theme="light"] .footer-link a:hover {
            color: #000;
        }
    </style>
</head>
<body>
    <!-- FIXED HEADER -->
    <div class="fixed-header">
        <div class="header-content">
            <div class="header-controls">
                <button class="theme-toggle" id="themeToggle">
                    <span class="theme-icon" id="themeIcon">🌙</span>
                    <span id="themeText">Dark</span>
                </button>
                <div class="dropdown-container">
                    <button class="dropdown-button" id="dropdownButton">
                        <span id="selectedCountry">🌎 All</span>
                        <span class="dropdown-arrow">▼</span>
                    </button>
                    <div class="dropdown-menu" id="dropdownMenu">
                        <div class="dropdown-option selected" data-country="all">🌎 All</div>
                        <div class="dropdown-option" data-country="Poland">🇵🇱 POLAND</div>
                        <div class="dropdown-option" data-country="Austria">🇦🇹 AUSTRIA</div>
                        <div class="dropdown-option" data-country="Lithuania">🇱🇹 LITHUANIA</div>
                        <div class="dropdown-option" data-country="Denmark">🇩🇰 DENMARK</div>
                        <div class="dropdown-option" data-country="Spain">🇪🇸 SPAIN</div>
                        <div class="dropdown-option" data-country="Portugal">🇵🇹 PORTUGAL</div>
                        <div class="dropdown-option" data-country="Italy">🇮🇹 ITALY</div>
                        <div class="dropdown-option" data-country="Greece">🇬🇷 GREECE</div>
                        <div class="dropdown-option" data-country="France">🇫🇷 FRANCE</div>
                    </div>
                </div>
            </div>
            <h1 class="header-title">VARUN.SURF</h1>
        </div>
    </div>

    <!-- MAIN CONTENT -->
    <div class="main-content">
        <div class="container">
            <div class="spots-grid" id="spotsGrid">
                <!-- Spots will be generated by JavaScript -->
            </div>
        </div>

        <footer class="footer">
            <div class="footer-content">
                <p>weather forecast and real-time wind conditions dashboard for kitesurfers</p>
                <p class="footer-disclaimer">weather data provided by <a href="https://windguru.cz" target="_blank" class="footer-external-link">windguru.cz</a>, <a href="https://windfinder.com" target="_blank" class="footer-external-link">windfinder.com</a>, <a href="https://wiatrkadyny.pl" target="_blank" class="footer-external-link">wiatrkadyny.pl</a>, <a href="https://kiteriders.at" target="_blank" class="footer-external-link">kiteriders.at</a></p>
                <p class="footer-link">&copy; 2025 <a href="https://varun.surf">varun.surf</a> | made in 🇵🇱 by <a href="https://wittchen.io" target="_blank" class="footer-external-link">Piotr Wittchen</a> | v. 0.0.1</p>
            </div>
        </footer>
    </div>

    <!-- Modal for AI Analysis -->
    <div class="modal-overlay" id="aiModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">
                    <span>⟡</span>
                    <span id="modalSpotName">AI Analysis</span>
                </div>
                <button class="modal-close" id="modalClose">&times;</button>
            </div>
            <div class="modal-content">
                <div class="ai-analysis" id="aiAnalysisContent">
                    <!-- AI analysis content will be inserted here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for Spot Info -->
    <div class="modal-overlay" id="infoModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">
                    <span>ⓘ</span>
                    <span id="infoModalSpotName">Spot Information</span>
                </div>
                <button class="modal-close" id="infoModalClose">&times;</button>
            </div>
            <div class="modal-content">
                <div class="spot-info" id="spotInfoContent">
                    <!-- Spot information content will be inserted here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        let globalWeatherData = [];

        // Mock data with enhanced spot information including seasonal data
        const mockData = [
            {
                "name": "Jastarnia",
                "country": "Poland",
                "windguruUrl": "https://www.windguru.cz/station/327",
                "windfinderUrl": "https://www.windfinder.com/forecast/jastarnia",
                "icmUrl": "https://www.meteo.pl/um/metco/mgram_pict.php?ntype=0u&row=339&col=213&lang=pl",
                "webcamUrl": "https://www.windfinder.com/webcams/c/jastarnia",
                "locationUrl": "https://maps.google.com/maps?q=Jastarnia,Poland",
                "lastUpdated": "2025-05-26 14:23",
                "currentConditions": { "wind": 16, "gusts": 22, "direction": "W", "temp": 18, "wave": 1.2 },
                "forecast": [
                    { "date": "Today", "wind": 18, "gusts": 24, "direction": "W", "temp": 19, "precipitation": 0, "wave": 1.4 },
                    { "date": "Tomorrow", "wind": 15, "gusts": 20, "direction": "NW", "temp": 17, "precipitation": 5, "wave": 1.1 },
                    { "date": "Day 3", "wind": 22, "gusts": 28, "direction": "W", "temp": 20, "precipitation": 0, "wave": 1.8 },
                    { "date": "Day 4", "wind": 8, "gusts": 12, "direction": "SW", "temp": 22, "precipitation": 10, "wave": 0.5 },
                    { "date": "Day 5", "wind": 16, "gusts": 22, "direction": "W", "temp": 19, "precipitation": 0, "wave": 1.0 }
                ],
                "spotInfo": {
                    "type": "Beach Break",
                    "bestWind": "W, SW, NW",
                    "waterTemp": "12-18°C",
                    "experience": "Beginner to Advanced",
                    "launch": "Sandy Beach",
                    "hazards": "Shallow areas, swimmers in summer",
                    "season": "May-October (peak: Jul-Aug). Strong winds common in autumn/winter but cold water requires thick wetsuit. Summer offers warmest water but can be crowded.",
                    "description": "Jastarnia is one of Poland's most popular kitesurfing spots, located on the Hel Peninsula. The spot offers excellent conditions with westerly winds and a wide sandy beach perfect for launching. The shallow lagoon side is ideal for beginners, while the open Baltic Sea side provides more challenging conditions for advanced riders."
                },
                "aiAnalysis": "<h3>🏄‍♂️ Session Recommendation</h3><p>Jastarnia is showing <span class=\"ai-highlight\">excellent conditions</span> for the next few days! The consistent westerly winds are perfect for the main beach launch.</p><h3>📊 Wind Analysis</h3><p>Current 16kt winds with 22kt gusts provide solid intermediate conditions. Day 3 looks particularly promising with <span class=\"ai-highlight\">22kt sustained winds</span> - perfect for advanced sessions and big air attempts.</p><h3>🎯 Best Session Times</h3><ul><li><strong>Today:</strong> Afternoon sessions recommended (18kt sustained)</li><li><strong>Day 3:</strong> All-day conditions with strong westerly (22kt)</li><li><strong>Avoid Day 4:</strong> Light winds (8kt) - better for beginners or SUP</li></ul><h3>🌊 Local Conditions</h3><p>West winds are offshore at Jastarnia's main spot, creating clean, organized waves. Water temperature around 12-15°C requires a good wetsuit. The sandy bottom and wide beach make it perfect for launching in these conditions.</p>"
            },
            {
                "name": "Tarifa",
                "country": "Spain",
                "windguruUrl": "https://www.windguru.cz/station/327",
                "windfinderUrl": "https://www.windfinder.com/forecast/tarifa",
                "webcamUrl": "https://www.windfinder.com/webcams/c/tarifa",
                "locationUrl": "https://maps.google.com/maps?q=Tarifa,Spain",
                "lastUpdated": "2025-05-26 14:23",
                "currentConditions": { "wind": 16, "gusts": 22, "direction": "W", "temp": 21, "wave": 0.8 },
                "forecast": [
                    { "date": "Today", "wind": 18, "gusts": 24, "direction": "W", "temp": 22, "precipitation": 0, "wave": 1.0 },
                    { "date": "Tomorrow", "wind": 15, "gusts": 20, "direction": "NW", "temp": 20, "precipitation": 5, "wave": 0.7 },
                    { "date": "Day 3", "wind": 22, "gusts": 28, "direction": "W", "temp": 23, "precipitation": 0, "wave": 1.5 },
                    { "date": "Day 4", "wind": 8, "gusts": 12, "direction": "SW", "temp": 25, "precipitation": 10, "wave": 0.4 },
                    { "date": "Day 5", "wind": 16, "gusts": 22, "direction": "W", "temp": 21, "precipitation": 0, "wave": 0.9 }
                ],
                "spotInfo": {
                    "type": "Multiple spots",
                    "bestWind": "E (Levante), W (Poniente)",
                    "waterTemp": "16-22°C",
                    "experience": "All levels",
                    "launch": "Various beaches",
                    "hazards": "Strong currents, crowded in summer",
                    "season": "Year-round destination. Best: Apr-Oct with consistent Poniente winds. Jul-Sep: Peak season with Levante and crowds. Winter: Strong winds but cooler, fewer crowds.",
                    "description": "Tarifa is the kitesurfing capital of Europe, located at the southern tip of Spain where the Mediterranean meets the Atlantic. The area offers multiple world-class spots including Punta Paloma (flat water), Los Lances (waves), and Valdevaqueros (all conditions). Famous for consistent winds and year-round kitesurfing."
                },
                "aiAnalysis": "<h3>🌪️ Legendary Conditions Ahead</h3><p>Tarifa is living up to its reputation as Europe's wind capital! <span class=\"ai-highlight\">Consistent westerly flow</span> with building intensity through Day 3.</p><h3>🎯 Spot Selection</h3><ul><li><strong>Punta Paloma:</strong> Perfect for current W/NW winds - flatwater freestyle paradise</li><li><strong>Los Lances:</strong> Great for wave riding when winds hit 22kt on Day 3</li><li><strong>Valdevaqueros:</strong> Best backup if winds get too strong</li></ul><h3>⚡ Power Days</h3><p>Day 3 is shaping up to be <span class=\"ai-highlight\">epic</span> with 22kt sustained and 28kt gusts. Perfect conditions for powered sessions and big jumps. The thermal enhancement typical of Tarifa should add 3-5kts in the afternoon.</p><h3>🌡️ Comfort Factor</h3><p>Excellent temperatures (20-25°C) mean comfortable sessions in shorty wetsuits or even boardshorts. The levante isn't showing up, so expect manageable sea state throughout the forecast period.</p>"
            },
            {
                "name": "Lagos",
                "country": "Portugal",
                "windguruUrl": "https://www.windguru.cz/station/785",
                "windfinderUrl": "https://www.windfinder.com/forecast/lagos_portugal",
                "locationUrl": "https://maps.google.com/maps?q=Lagos,Portugal",
                "lastUpdated": "2025-05-26 14:18",
                "forecast": [
                    { "date": "Today", "wind": 12, "gusts": 16, "direction": "NW", "temp": 19, "precipitation": 0 },
                    { "date": "Tomorrow", "wind": 9, "gusts": 13, "direction": "W", "temp": 18, "precipitation": 15 },
                    { "date": "Day 3", "wind": 14, "gusts": 19, "direction": "NW", "temp": 20, "precipitation": 0 },
                    { "date": "Day 4", "wind": 6, "gusts": 10, "direction": "SW", "temp": 22, "precipitation": 5 },
                    { "date": "Day 5", "wind": 11, "gusts": 15, "direction": "W", "temp": 19, "precipitation": 0 }
                ],
                "spotInfo": {
                    "type": "Protected Bay",
                    "bestWind": "NW, W, SW",
                    "waterTemp": "16-20°C",
                    "experience": "Beginner to Intermediate",
                    "launch": "Sandy beach",
                    "hazards": "Rocks on sides, boat traffic",
                    "season": "Mar-Nov optimal. Jun-Sep: Warmest water (18-20°C) and most reliable afternoon thermal winds. Spring/Autumn: Cooler but less crowded, good learning conditions.",
                    "description": "Lagos offers excellent learning conditions in a protected bay setting on Portugal's stunning Algarve coast. Meia Praia is the main spot with a long sandy beach and generally flat water. The spot is perfect for progression with consistent moderate winds and beautiful surroundings."
                },
                "aiAnalysis": "<h3>🌊 Moderate Conditions - Perfect for Progression</h3><p>Lagos is showing <span class=\"ai-highlight\">ideal learning conditions</span> with moderate winds and manageable sea state. Great opportunity for skill development and relaxed sessions.</p><h3>📚 Session Planning</h3><ul><li><strong>Today & Day 3:</strong> Best sessions (12-14kt) - perfect for intermediate riders</li><li><strong>Tomorrow:</strong> Light winds + rain - indoor theory day</li><li><strong>Day 4:</strong> Very light (6kt) - SUP or light wind practice</li></ul><h3>🏖️ Spot Recommendations</h3><p>The northwest winds are perfect for <span class=\"ai-highlight\">Meia Praia</span> - Lagos' main kitesurfing beach. The long sandy beach provides plenty of space for safe launching and landing. Protected bay conditions mean smaller waves, ideal for freestyle practice.</p><h3>🎓 Skills Focus</h3><p>These moderate conditions are perfect for working on transitions, jumps, and new tricks. The forgiving wind strength allows for progression without being overpowering. Consider larger kite sizes (12-14m) for optimal performance.</p>"
            },
            {
                "name": "Marseille",
                "country": "France",
                "windguruUrl": "https://www.windguru.cz/station/156",
                "windfinderUrl": "https://www.windfinder.com/forecast/marseille",
                "webcamUrl": "https://www.windfinder.com/webcams/c/marseille",
                "locationUrl": "https://maps.google.com/maps?q=Marseille,France",
                "lastUpdated": "2025-05-26 14:31",
                "currentConditions": { "wind": 24, "gusts": 31, "direction": "N", "temp": 17, "wave": 2.1 },
                "forecast": [
                    { "date": "Today", "wind": 25, "gusts": 32, "direction": "N", "temp": 16, "precipitation": 0, "wave": 2.3 },
                    { "date": "Tomorrow", "wind": 28, "gusts": 35, "direction": "N", "temp": 15, "precipitation": 0, "wave": 2.8 },
                    { "date": "Day 3", "wind": 20, "gusts": 26, "direction": "NW", "temp": 17, "precipitation": 5, "wave": 1.7 },
                    { "date": "Day 4", "wind": 15, "gusts": 20, "direction": "W", "temp": 19, "precipitation": 10, "wave": 1.2 },
                    { "date": "Day 5", "wind": 10, "gusts": 14, "direction": "SW", "temp": 21, "precipitation": 20, "wave": 0.8 }
                ],
                "spotInfo": {
                    "type": "Open Sea",
                    "bestWind": "N (Mistral), NW",
                    "waterTemp": "15-19°C",
                    "experience": "Intermediate to Advanced",
                    "launch": "Rocky/Sandy areas",
                    "hazards": "Strong Mistral winds, choppy seas",
                    "season": "Apr-Oct best period. May-Jun & Sep-Oct: Ideal with strong Mistral and fewer crowds. Jul-Aug: Hottest but crowded. Winter: Powerful Mistral but cold water (12-14°C).",
                    "description": "Marseille benefits from the famous Mistral winds that create excellent but challenging conditions. The spot offers various launch points around the coast, with Plage du Prado being popular. When the Mistral blows, conditions can be very powerful - perfect for experienced riders seeking high-performance sessions."
                }
            },
            {
                "name": "Cagliari",
                "country": "Italy",
                "windguruUrl": "https://www.windguru.cz/station/912",
                "windfinderUrl": "https://www.windfinder.com/forecast/cagliari",
                "locationUrl": "https://maps.google.com/maps?q=Cagliari,Italy",
                "lastUpdated": "2025-05-26 14:15",
                "forecast": [
                    { "date": "Today", "wind": 13, "gusts": 18, "direction": "NW", "temp": 24, "precipitation": 0 },
                    { "date": "Tomorrow", "wind": 16, "gusts": 21, "direction": "N", "temp": 22, "precipitation": 0 },
                    { "date": "Day 3", "wind": 7, "gusts": 11, "direction": "SW", "temp": 26, "precipitation": 15 },
                    { "date": "Day 4", "wind": 19, "gusts": 25, "direction": "NW", "temp": 23, "precipitation": 0 },
                    { "date": "Day 5", "wind": 12, "gusts": 16, "direction": "W", "temp": 25, "precipitation": 5 }
                ],
                "spotInfo": {
                    "type": "Beach and Bay",
                    "bestWind": "NW, N, W",
                    "waterTemp": "18-24°C",
                    "experience": "All levels",
                    "launch": "Poetto Beach (sand)",
                    "hazards": "Rocks at some spots, thermal winds",
                    "season": "Apr-Oct ideal. Jun-Sep: Peak season with warmest water (22-24°C) and strong afternoon thermals. May & Oct: Cooler but excellent with fewer crowds. Winter possible but requires wetsuit.",
                    "description": "Cagliari on the southern coast of Sardinia offers excellent Mediterranean kitesurfing with warm water and reliable thermal winds. Poetto Beach is the main 8km stretch perfect for all levels. The spot benefits from both gradient and thermal winds, often picking up in the afternoon."
                },
                "aiAnalysis": "<h3>🛖 Sardinian Sessions - Variable but Promising</h3><p>Cagliari shows <span class=\"ai-highlight\">mixed conditions</span> with some excellent sessions bookending lighter days. The Mediterranean's thermal effects will enhance afternoon winds.</p><h3>📅 Session Planner</h3><ul><li><strong>Today:</strong> Moderate NW winds (13kt) - good for progression</li><li><strong>Tomorrow:</strong> Solid conditions (16kt N) - best day of forecast</li><li><strong>Day 3:</strong> Too light (7kt) - rest day or SUP</li><li><strong>Day 4:</strong> Strong return (19kt NW) - powered sessions</li></ul><h3>🌡️ Mediterranean Advantage</h3><p>Excellent water temperatures (20-22°C) and air temps (22-26°C) mean comfortable sessions in minimal gear. The warm conditions make even the lighter wind days enjoyable for relaxed cruising.</p><h3>🏖 Spot Selection</h3><p><strong>Poetto Beach</strong> is perfect for the NW winds - long sandy beach with good space. When winds turn northerly tomorrow, consider <strong>Calamosca</strong> for more protected conditions and stunning scenery.</p>"
            },
            {
                "name": "Mykonos",
                "country": "Greece",
                "windguruUrl": "https://www.windguru.cz/station/493",
                "windfinderUrl": "https://www.windfinder.com/forecast/mykonos",
                "webcamUrl": "https://www.windfinder.com/webcams/c/mykonos",
                "locationUrl": "https://maps.google.com/maps?q=Mykonos,Greece",
                "lastUpdated": "2025-05-26 14:27",
                "currentConditions": { "wind": 28, "gusts": 36, "direction": "N", "temp": 19, "wave": 3.2 },
                "forecast": [
                    { "date": "Today", "wind": 30, "gusts": 38, "direction": "N", "temp": 20, "precipitation": 0, "wave": 3.5 },
                    { "date": "Tomorrow", "wind": 26, "gusts": 33, "direction": "N", "temp": 19, "precipitation": 0, "wave": 2.9 },
                    { "date": "Day 3", "wind": 22, "gusts": 28, "direction": "NW", "temp": 21, "precipitation": 0, "wave": 2.2 },
                    { "date": "Day 4", "wind": 18, "gusts": 24, "direction": "NW", "temp": 23, "precipitation": 5, "wave": 1.8 },
                    { "date": "Day 5", "wind": 8, "gusts": 12, "direction": "SW", "temp": 25, "precipitation": 10, "wave": 0.6 }
                ],
                "spotInfo": {
                    "type": "Exposed Beaches",
                    "bestWind": "N (Meltemi), NW",
                    "waterTemp": "18-23°C",
                    "experience": "Intermediate to Expert",
                    "launch": "Multiple beach breaks",
                    "hazards": "Very strong Meltemi, large waves, rocks",
                    "season": "May-Oct optimal. Jul-Sep: Peak Meltemi season (20-35kt daily), warmest water but very crowded. Jun & Oct: Strong winds, fewer crowds. Apr-May & Oct-Nov: Variable but good learning periods.",
                    "description": "Mykonos is famous for the powerful Meltemi winds that create world-class but challenging conditions. Kalafatis Beach and Ftelia Beach are the main spots. When the Meltemi blows (July-September especially), conditions are incredible but only suitable for experienced riders. Crystal clear Aegean waters and stunning scenery."
                },
                "aiAnalysis": "<h3>🌪️ Meltemi Madness - Epic Conditions!</h3><p>The famous <span class=\"ai-highlight\">Meltemi winds</span> are delivering absolutely incredible conditions! 30kt sustained with 38kt gusts - this is world-class kitesurfing territory.</p><h3>⚡ Power Sessions Only</h3><p><span class=\"ai-highlight\">Expert riders only</span> for the next 3 days. These are seriously powered conditions that require advanced skills, small kites (5-7m), and complete comfort in strong winds.</p><h3>🏝️ Greek Island Paradise</h3><ul><li><strong>Kalafatis Beach:</strong> Main spot - perfect for these northerly Meltemi winds</li><li><strong>Ftelia Beach:</strong> Alternative option with slightly more protection</li><li><strong>Water temp:</strong> 18-20°C - wetsuit recommended</li></ul><h3>📊 Wind Evolution</h3><p>Peak power today and tomorrow (26-30kt), then gradual decrease. Day 4-5 offer more accessible conditions (18kt down to 8kt) perfect for less experienced riders or gear testing.</p><h3>🎯 Pro Tip</h3><p>The Meltemi is remarkably consistent and clean - expect steady power without the gustiness of many other strong wind locations. Perfect for big air, speed runs, and advanced freestyle.</p>"
            },
            {
                "name": "Cádiz",
                "country": "Spain",
                "windguruUrl": "https://www.windguru.cz/station/421",
                "windfinderUrl": "https://www.windfinder.com/forecast/cadiz",
                "locationUrl": "https://maps.google.com/maps?q=Cadiz,Spain",
                "lastUpdated": "2025-05-26 14:20",
                "forecast": [
                    { "date": "Today", "wind": 14, "gusts": 19, "direction": "W", "temp": 23, "precipitation": 0 },
                    { "date": "Tomorrow", "wind": 11, "gusts": 15, "direction": "SW", "temp": 24, "precipitation": 10 },
                    { "date": "Day 3", "wind": 17, "gusts": 22, "direction": "W", "temp": 22, "precipitation": 0 },
                    { "date": "Day 4", "wind": 5, "gusts": 8, "direction": "S", "temp": 26, "precipitation": 20 },
                    { "date": "Day 5", "wind": 20, "gusts": 26, "direction": "NW", "temp": 21, "precipitation": 0 }
                ],
                "spotInfo": {
                    "type": "Atlantic Coast",
                    "bestWind": "W, NW, SW",
                    "waterTemp": "16-21°C",
                    "experience": "All levels",
                    "launch": "Sandy beaches",
                    "hazards": "Atlantic swells, currents",
                    "season": "Mar-Nov best period. Jun-Sep: Warmest water and reliable thermals but more crowded. Apr-May & Oct-Nov: Cooler but consistent winds, fewer people. Winter sessions possible but cold.",
                    "description": "Cádiz offers authentic Spanish Atlantic coast kitesurfing with a rich historical backdrop. Playa de la Victoria in the city and nearby El Palmar provide excellent wave sailing opportunities. The area benefits from consistent Atlantic swells and good wind exposure. Less crowded than Mediterranean spots."
                },
                "aiAnalysis": "<h3>🏰 Historic Cadiz - Varied Conditions</h3><p>Cádiz is showing a <span class=\"ai-highlight\">rollercoaster forecast</span> - from solid sessions to light winds and back to powered conditions. Perfect for a varied kitesurfing week!</p><h3>📈 Session Strategy</h3><ul><li><strong>Today:</strong> Good intermediate conditions (14kt W)</li><li><strong>Tomorrow:</strong> Light + rainy - equipment maintenance day</li><li><strong>Day 3:</strong> Solid return (17kt W) - great session day</li><li><strong>Day 4:</strong> Too light (5kt) - explore the beautiful old town</li><li><strong>Day 5:</strong> Strong finish (20kt NW) - powered session</li></ul><h3>🌊 Atlantic Edge</h3><p>Cádiz benefits from its Atlantic exposure with consistent swells and clean wind patterns. The westerly winds create excellent wave sailing opportunities, while the sandy beaches provide safe launching.</p><h3>🏖️ Spot Recommendations</h3><p><strong>Playa de la Victoria</strong> works well for most wind directions, while <strong>El Palmar</strong> (20min drive) offers world-class wave conditions when the winds pick up on Days 3 and 5.</p>"
            }
        ];

        // Theme functionality
        function initTheme() {
            const savedTheme = localStorage.getItem('theme') || 'dark';
            const themeToggle = document.getElementById('themeToggle');
            const themeIcon = document.getElementById('themeIcon');
            const themeText = document.getElementById('themeText');
            
            function updateTheme(theme) {
                document.documentElement.setAttribute('data-theme', theme);
                if (theme === 'light') {
                    themeIcon.textContent = '☀️';
                    themeText.textContent = 'Light';
                } else {
                    themeIcon.textContent = '🌙';
                    themeText.textContent = 'Dark';
                }
                localStorage.setItem('theme', theme);
            }

            // Set initial theme
            updateTheme(savedTheme);

            // Theme toggle event
            themeToggle.addEventListener('click', () => {
                const currentTheme = document.documentElement.getAttribute('data-theme');
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                updateTheme(newTheme);
            });
        }

        function fetchWeatherData() {
            // Simulate API call with mock data
            return new Promise((resolve) => {
                setTimeout(() => {
                    resolve(mockData);
                }, 1000);
            });
        }

        function showLoadingMessage() {
            const spotsGrid = document.getElementById('spotsGrid');
            spotsGrid.innerHTML = `
                <div class="loading-message">
                    <div class="loading-spinner"></div>
                    <span class="loading-text">Loading weather data...</span>
                </div>
            `;
        }

        function showErrorMessage(error) {
            const spotsGrid = document.getElementById('spotsGrid');
            
            let errorTitle = 'Failed to Load Weather Data';
            let errorMessage = 'Unable to fetch the latest weather information.';
            
            if (error.message.includes('HTTP Error: 404')) {
                errorTitle = 'Data Source Not Found';
                errorMessage = 'The weather data source is currently unavailable. This might be a temporary issue with the server.';
            } else if (error.message.includes('HTTP Error: 500')) {
                errorTitle = 'Server Error';
                errorMessage = 'The weather service is experiencing technical difficulties. Please try again later.';
            } else if (error.message.includes('Failed to fetch') || error.message.includes('NetworkError')) {
                errorTitle = 'Connection Error';
                errorMessage = 'Unable to connect to the weather service. Please check your internet connection and try again.';
            } else if (error.message.includes('JSON')) {
                errorTitle = 'Data Format Error';
                errorMessage = 'The weather data received is corrupted or in an unexpected format.';
            }
            
            spotsGrid.innerHTML = `
                <div class="error-message">
                    <span class="error-icon">⚠️</span>
                    <div class="error-title">${errorTitle}</div>
                    <div class="error-description">
                        ${errorMessage}<br/>
                        Please refresh the page to try again.
                    </div>
                </div>
            `;
        }

        function getWindArrow(direction) {
            const arrows = {
                'N': '↓',
                'NE': '↙',
                'E': '←',
                'SE': '↖',
                'S': '↑',
                'SW': '↗',
                'W': '→',
                'NW': '↘'
            };
            return arrows[direction] || '•';
        }

        function openAIModal(spotName) {
            const spot = globalWeatherData.find(spot => spot.name === spotName);
            if (!spot || !spot.aiAnalysis) return;

            const modal = document.getElementById('aiModal');
            const modalSpotName = document.getElementById('modalSpotName');
            const aiAnalysisContent = document.getElementById('aiAnalysisContent');

            modalSpotName.textContent = `AI Analysis - ${spotName}`;
            aiAnalysisContent.innerHTML = spot.aiAnalysis.trim();
            
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function openInfoModal(spotName) {
            const spot = globalWeatherData.find(spot => spot.name === spotName);
            if (!spot || !spot.spotInfo) return;

            const modal = document.getElementById('infoModal');
            const modalSpotName = document.getElementById('infoModalSpotName');
            const spotInfoContent = document.getElementById('spotInfoContent');

            modalSpotName.textContent = `${spotName}`;
            
            const info = spot.spotInfo;
            spotInfoContent.innerHTML = `
                <h3>🏄 Overview</h3>
                <p>${info.description}</p>
                
                <div class="info-grid">
                    <div class="info-item">
                        <div class="info-label">Spot Type</div>
                        <div class="info-value">${info.type}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Best Wind</div>
                        <div class="info-value">${info.bestWind}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Water Temperature</div>
                        <div class="info-value">${info.waterTemp}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Experience Level</div>
                        <div class="info-value">${info.experience}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Launch Type</div>
                        <div class="info-value">${info.launch}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Hazards</div>
                        <div class="info-value">${info.hazards}</div>
                    </div>
                </div>
                
                <h3>📅 Season</h3>
                <p>${info.season}</p>
            `;
            
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeAIModal() {
            const modal = document.getElementById('aiModal');
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        function closeInfoModal() {
            const modal = document.getElementById('infoModal');
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        function createSpotCard(spot) {
            const card = document.createElement('div');
            card.className = 'spot-card';
            card.dataset.country = spot.country;

            // Check if spot has wave data
            const hasWaveData = spot.forecast.some(day => day.wave !== undefined) || 
                               (spot.currentConditions && spot.currentConditions.wave !== undefined);

            let forecastRows = '';
            spot.forecast.forEach(day => {
                let windClass, windTextClass;
                if (day.wind < 12) {
                    windClass = 'weak-wind';
                    windTextClass = 'wind-weak';
                } else if (day.wind >= 12 && day.wind < 15) {
                    windClass = 'moderate-wind';
                    windTextClass = 'wind-moderate';
                } else if (day.wind >= 15 && day.wind <= 22) {
                    windClass = 'strong-wind';
                    windTextClass = 'wind-strong';
                } else {
                    windClass = 'extreme-wind';
                    windTextClass = 'wind-extreme';
                }

                const tempClass = day.temp >= 20 ? 'temp-positive' : 'temp-negative';
                const windArrow = getWindArrow(day.direction);
                const precipClass = day.precipitation === 0 ? 'precipitation-none' : 'precipitation';
                
                // Wave classes
                let waveClass = '';
                let waveText = '-';
                if (day.wave !== undefined) {
                    if (day.wave < 1.0) {
                        waveClass = 'wave-small';
                    } else if (day.wave >= 1.0 && day.wave < 2.0) {
                        waveClass = 'wave-moderate';
                    } else {
                        waveClass = 'wave-large';
                    }
                    waveText = `${day.wave}`;
                }

                forecastRows += `
                    <tr class="${windClass}">
                        <td><strong>${day.date}</strong></td>
                        <td class="${windTextClass}">${day.wind} kts</td>
                        <td class="${windTextClass}">${day.gusts} kts</td>
                        <td class="${windTextClass}">
                            <span class="wind-arrow">${windArrow}</span> ${day.direction}
                        </td>
                        <td class="${tempClass}">${day.temp}°C</td>
                        <td class="${precipClass}">${day.precipitation}%</td>
                        ${hasWaveData ? `<td class="${waveClass}">${waveText}</td>` : ''}
                    </tr>
                `;
            });

            let currentConditionsRow = '';
            if (spot.currentConditions) {
                let windClass, windTextClass;
                if (spot.currentConditions.wind < 12) {
                    windClass = 'weak-wind';
                    windTextClass = 'wind-weak';
                } else if (spot.currentConditions.wind >= 12 && spot.currentConditions.wind < 15) {
                    windClass = 'moderate-wind';
                    windTextClass = 'wind-moderate';
                } else if (spot.currentConditions.wind >= 15 && spot.currentConditions.wind <= 22) {
                    windClass = 'strong-wind';
                    windTextClass = 'wind-strong';
                } else {
                    windClass = 'extreme-wind';
                    windTextClass = 'wind-extreme';
                }

                const tempClass = spot.currentConditions.temp >= 20 ? 'temp-positive' : 'temp-negative';
                const windArrow = getWindArrow(spot.currentConditions.direction);
                
                // Current wave conditions
                let currentWaveClass = '';
                let currentWaveText = '-';
                if (spot.currentConditions.wave !== undefined) {
                    if (spot.currentConditions.wave < 1.0) {
                        currentWaveClass = 'wave-small';
                    } else if (spot.currentConditions.wave >= 1.0 && spot.currentConditions.wave < 2.0) {
                        currentWaveClass = 'wave-moderate';
                    } else {
                        currentWaveClass = 'wave-large';
                    }
                    currentWaveText = `${spot.currentConditions.wave}`;
                }

                currentConditionsRow = `
                    <tr class="${windClass}" style="border-top: 2px solid #404040;">
                        <td>
                            <div class="live-indicator">
                                <strong>NOW</strong>
                                <div class="live-dot"></div>
                            </div>
                        </td>
                        <td class="${windTextClass}">${spot.currentConditions.wind} kts</td>
                        <td class="${windTextClass}">${spot.currentConditions.gusts} kts</td>
                        <td class="${windTextClass}">
                            <span class="wind-arrow">${windArrow}</span> ${spot.currentConditions.direction}
                        </td>
                        <td class="${tempClass}">${spot.currentConditions.temp}°C</td>
                        <td>-</td>
                        ${hasWaveData ? `<td class="${currentWaveClass}">${currentWaveText}</td>` : ''}
                    </tr>
                `;
            }

            card.innerHTML = `
                <div class="spot-header">
                    <div class="spot-title">
                        <div class="spot-name">${spot.name}</div>
                    </div>
                    <div class="spot-meta">
                        <div class="country-tag">${spot.country}</div>
                        <div class="last-updated">${spot.lastUpdated}</div>
                    </div>
                </div>
                <div class="external-links">
                    ${spot.spotInfo ? `<span class="external-link info-link" onclick="openInfoModal('${spot.name}')"></span>` : ''}
                    <a href="${spot.windguruUrl}" target="_blank" class="external-link">Windguru</a>
                    <a href="${spot.windfinderUrl}" target="_blank" class="external-link">Windfinder</a>
                    ${spot.icmUrl ? `<a href="${spot.icmUrl}" target="_blank" class="external-link">ICM</a>` : ''}
                    ${spot.webcamUrl ? `<a href="${spot.webcamUrl}" target="_blank" class="external-link webcam-link">Webcam</a>` : ''}
                    <a href="${spot.locationUrl}" target="_blank" class="external-link location-link">Location</a>
                    ${spot.aiAnalysis ? `<span class="external-link ai-link" onclick="openAIModal('${spot.name}')">AI</span>` : ''}
                </div>
                <table class="weather-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Wind</th>
                            <th>Gusts</th>
                            <th>Direction</th>
                            <th>Temp</th>
                            <th>Rain</th>
                            ${hasWaveData ? '<th>Wave</th>' : ''}
                        </tr>
                    </thead>
                    <tbody>
                        ${forecastRows}
                        ${currentConditionsRow}
                    </tbody>
                </table>
            `;

            return card;
        }

        let currentFilter = 'all';

        function renderSpots(filter = 'all') {
            currentFilter = filter;
            const spotsGrid = document.getElementById('spotsGrid');
            
            showLoadingMessage();
            
            fetchWeatherData()
                .then(data => {
                    globalWeatherData = data;
                    const filteredSpots = filter === 'all' ? data : data.filter(spot => spot.country === filter);
                    
                    spotsGrid.innerHTML = '';
                    filteredSpots.forEach(spot => {
                        spotsGrid.appendChild(createSpotCard(spot));
                    });
                })
                .catch(error => {
                    console.error('Failed to load weather:', error.message);
                    showErrorMessage(error);
                });
        }

        function setupDropdown() {
            const dropdownButton = document.getElementById('dropdownButton');
            const dropdownMenu = document.getElementById('dropdownMenu');
            const selectedCountry = document.getElementById('selectedCountry');
            const dropdownOptions = document.querySelectorAll('.dropdown-option');

            function closeDropdown() {
                dropdownButton.classList.remove('open', 'active');
                dropdownMenu.classList.remove('open');
            }

            dropdownButton.addEventListener('click', (e) => {
                e.stopPropagation();
                if (dropdownMenu.classList.contains('open')) {
                    closeDropdown();
                } else {
                    dropdownButton.classList.add('open', 'active');
                    dropdownMenu.classList.add('open');
                }
            });


            dropdownOptions.forEach(option => {
                option.addEventListener('click', (e) => {
                    e.stopPropagation();
                    
                    dropdownOptions.forEach(opt => opt.classList.remove('selected'));
                    option.classList.add('selected');
                    
                    selectedCountry.textContent = option.textContent;
                    renderSpots(option.dataset.country);
                    closeDropdown();
                    
                    // Scroll to top smoothly after country selection
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                });
            });

            document.addEventListener('click', (e) => {
                if (!dropdownButton.contains(e.target) && !dropdownMenu.contains(e.target)) {
                    closeDropdown();
                }
            });

            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && dropdownMenu.classList.contains('open')) {
                    closeDropdown();
                    dropdownButton.focus();
                }
            });
        }

        function setupModals() {
            const aiModal = document.getElementById('aiModal');
            const aiCloseButton = document.getElementById('modalClose');
            const infoModal = document.getElementById('infoModal');
            const infoCloseButton = document.getElementById('infoModalClose');

            // AI Modal events
            aiCloseButton.addEventListener('click', closeAIModal);
            aiModal.addEventListener('click', (e) => {
                if (e.target === aiModal) {
                    closeAIModal();
                }
            });

            // Info Modal events
            infoCloseButton.addEventListener('click', closeInfoModal);
            infoModal.addEventListener('click', (e) => {
                if (e.target === infoModal) {
                    closeInfoModal();
                }
            });

            // Escape key for both modals
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    if (aiModal.classList.contains('active')) {
                        closeAIModal();
                    }
                    if (infoModal.classList.contains('active')) {
                        closeInfoModal();
                    }
                }
            });
        }

        // Make functions global for onclick handlers
        window.openAIModal = openAIModal;
        window.closeAIModal = closeAIModal;
        window.openInfoModal = openInfoModal;
        window.closeInfoModal = closeInfoModal;

        document.addEventListener('DOMContentLoaded', () => {
            initTheme();
            renderSpots();
            setupDropdown();
            setupModals();
        });
    </script>
</body>
</html>