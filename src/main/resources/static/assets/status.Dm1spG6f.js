import{t}from"./translations.BQoSS_OH.js";const e=localStorage.getItem("theme")||"dark";async function n(t){const e=document.querySelector(`[data-endpoint="${t}"]`),n=e.querySelector(".status-endpoint-status"),o=e.querySelector(".status-endpoint-dot");try{const e=performance.now(),s=await fetch(t),a=performance.now(),c=Math.round(a-e);s.ok?(n.innerHTML=`<span class="status-endpoint-text">operational</span> <span class="status-endpoint-latency">(${c}ms)</span>`,o.className="status-endpoint-dot status-endpoint-dot-up"):(n.innerHTML=`<span class="status-endpoint-text">error (${s.status})</span>`,o.className="status-endpoint-dot status-endpoint-dot-down")}catch(s){n.innerHTML='<span class="status-endpoint-text">unreachable</span>',o.className="status-endpoint-dot status-endpoint-dot-down"}}async function o(){await async function(){try{const t=await fetch("/api/v1/status");if(!t.ok)throw new Error("Failed to fetch status");const e=await t.json(),n=document.getElementById("status-indicator"),o=n.querySelector(".status-dot"),s=n.querySelector(".status-text");if("UP"===e.status?(o.className="status-dot status-dot-up",s.textContent="All Systems Operational"):(o.className="status-dot status-dot-down",s.textContent="System Issues Detected"),document.getElementById("version").textContent=e.version||"unknown",document.getElementById("uptime").textContent=e.uptime||"-",document.getElementById("spots-count").textContent=e.spotsCount||"0",document.getElementById("countries-count").textContent=e.countriesCount||"0",document.getElementById("live-stations").textContent=e.liveStations||"0",e.startTime){const t=new Date(e.startTime);document.getElementById("start-time").textContent=t.toLocaleString()}document.getElementById("last-updated").textContent="Last updated: "+(new Date).toLocaleTimeString()}catch(t){console.error("Error fetching status:",t);const e=document.getElementById("status-indicator"),n=e.querySelector(".status-dot"),o=e.querySelector(".status-text");n.className="status-dot status-dot-down",o.textContent="Unable to Connect"}}(),await async function(){await Promise.all(["/api/v1/health","/api/v1/status","/api/v1/spots"].map(n))}()}document.documentElement.setAttribute("data-theme",e),document.addEventListener("DOMContentLoaded",()=>{o(),setInterval(o,3e4),document.getElementById("refresh-status").addEventListener("click",o),function(){const e=document.querySelectorAll(".footer-year");if(e.length){const t=(new Date).getFullYear();e.forEach(e=>{e.textContent=t+" "})}const n=document.querySelector(".footer-disclaimer");n&&(n.textContent=t("footerDisclaimer"));const o=document.querySelectorAll(".footer-made-in");if(o.length){const e=t("footerMadeInLabel");o.forEach(t=>{t.textContent=e})}}()});
