import"./styles.4VNiTPXn.js";import{g as t,a as n}from"./translations.BlNwzw52.js";let e=null,i=null,o="en";async function s(t){try{const n=`/api/v1/spots/${t}`,e=await fetch(n);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return await e.json()}catch(n){throw console.error("Error fetching spot data:",n),n}}function c(t){return n[o]?.[t]||t}function a(t){return{N:"↓",NE:"↙",E:"←",SE:"↖",S:"↑",SW:"↗",W:"→",NW:"↘"}[t]||"•"}function d(t,n){const e=(t+n)/2;return e<12?"weak":e>=12&&e<18?"moderate":e>=18&&e<=25?"strong":"extreme"}function r(t){if(!t)return new Date;try{const n=t.trim().split(/\s+/);if(n.length>=5){const t=parseInt(n[1]),e=n[2],i=parseInt(n[3]),o=n[4].split(":"),s=parseInt(o[0]),c=parseInt(o[1]),a={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11}[e];if(void 0!==a){const n=new Date(i,a,t,s,c);if(!isNaN(n.getTime()))return n}}}catch(n){console.warn("Error parsing forecast date:",t,n)}return new Date}function l(n){e=n;const i=document.getElementById("tvSpotName"),o=document.getElementById("tvSpotCountry");if(i&&(i.textContent=n.name),o){const e=t(n.country),i=c(n.country)||n.country;o.textContent=`${e} ${i}`}document.title=`${n.name} - TV View - VARUN.SURF`;const s=n.forecastHourly&&n.forecastHourly.length>0?n.forecastHourly:n.forecast||[];let l=null,v="";if(n.currentConditions&&void 0!==n.currentConditions.wind)l={wind:n.currentConditions.wind,gusts:n.currentConditions.gusts,direction:n.currentConditions.direction,temp:n.currentConditions.temp,precipitation:0},v=c("tvCurrentConditionsLive");else if(s&&s.length>0){const t=function(t){if(!t||0===t.length)return null;const n=new Date;let e=t[0],i=Math.abs(r(t[0].date)-n);for(let o=1;o<t.length;o++){const s=r(t[o].date),c=Math.abs(s-n);c<i&&(i=c,e=t[o])}return e}(s);t&&(l={wind:t.wind,gusts:t.gusts,direction:t.direction,temp:t.temp,precipitation:t.precipitation||0},v=c("tvCurrentConditionsEstimated"))}let u="";if(l){const t=d(l.wind,l.gusts),n=a(l.direction),e={N:0,NE:45,E:90,SE:135,S:180,SW:225,W:270,NW:315}[l.direction]||0;u+=`\n            <div class="tv-current-conditions">\n                <div class="tv-conditions-label">${v}</div>\n                <div class="tv-wind-main">\n                    <div class="tv-wind-arrow" style="transform: rotate(${e}deg);">↓</div>\n                    <div class="tv-wind-speed ${t}">${l.wind} kts</div>\n                </div>\n                <div class="tv-conditions-grid">\n                    <div class="tv-condition-item">\n                        <div class="tv-condition-label">${c("gustsLabel")}</div>\n                        <div class="tv-condition-value ${t}">${l.gusts} kts</div>\n                    </div>\n                    <div class="tv-condition-item">\n                        <div class="tv-condition-label">${c("directionLabel")}</div>\n                        <div class="tv-condition-value">${n} ${l.direction}</div>\n                    </div>\n                    <div class="tv-condition-item">\n                        <div class="tv-condition-label">${c("tempLabel")}</div>\n                        <div class="tv-condition-value">${l.temp}°C</div>\n                    </div>\n                    <div class="tv-condition-item">\n                        <div class="tv-condition-label">${c("precipitationLabel")}</div>\n                        <div class="tv-condition-value">${l.precipitation} mm</div>\n                    </div>\n                </div>\n            </div>\n        `}if(s&&s.length>0){const t=function(t){const n=new Date,e=new Date(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),0,0);return t.filter(t=>r(t.date)>=e)}(s).slice(0,7);t.length>0&&(u+='\n                <div class="tv-forecast-section">\n                    <div class="tv-forecast-horizontal">\n            ',t.forEach(t=>{const n=function(t){if(!t)return"";const n=t.split(" ");return n.length>=5?n[4]:t}(t.date),e=d(t.wind,t.gusts),i=a(t.direction);u+=`\n                    <div class="tv-forecast-hour">\n                        <div class="tv-forecast-time">${n}</div>\n                        <div class="tv-forecast-data">\n                            <div class="tv-forecast-item">\n                                <div class="tv-forecast-item-value ${e}">${t.wind} kts</div>\n                            </div>\n                            <div class="tv-forecast-item">\n                                <div class="tv-forecast-item-value ${e}">${t.gusts} kts</div>\n                            </div>\n                            <div class="tv-forecast-item">\n                                <div class="tv-forecast-item-value">${i} ${t.direction}</div>\n                            </div>\n                            <div class="tv-forecast-item">\n                                <div class="tv-forecast-item-value">${t.temp}°C</div>\n                            </div>\n                        </div>\n                    </div>\n                `}),u+="\n                    </div>\n                </div>\n            ")}const m=document.getElementById("tvContent");m&&(m.innerHTML=u)}function v(t){const n=document.getElementById("tvContent");n&&(n.innerHTML=`<div class="tv-error">${t}</div>`)}async function u(){const t=function(){const t=window.location.pathname.split("/"),n=t.indexOf("spot");return-1!==n&&t.length>n+1?t[n+1]:null}();if(t)try{l(await s(t)),function(t){!i&&t&&(i=setInterval(async()=>{try{l(await s(t))}catch(n){console.warn("Auto refresh failed:",n)}},6e4))}(t)}catch(n){v("Failed to load spot data. Please try again."),console.error("Error loading spot:",n)}else v("Invalid spot ID")}document.addEventListener("DOMContentLoaded",function(){!function(){const t=localStorage.getItem("tvTheme")||"dark",n=document.getElementById("tvThemeToggle"),e=document.getElementById("tvThemeIcon");function i(t){document.documentElement.setAttribute("data-theme",t),e.innerHTML="light"===t?'<path d="M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5,5-2.24,5-5-2.24-5-5-5Zm0,7c-1.1,0-2-.9-2-2s.9-2,2-2,2,.9,2,2-.9,2-2,2Zm4.95-6.95c-.59-.59-.59-1.54,0-2.12l1.41-1.41c.59-.59,1.54-.59,2.12,0,.59,.59,.59,1.54,0,2.12l-1.41,1.41c-.29,.29-.68,.44-1.06,.44s-.77-.15-1.06-.44ZM7.05,16.95c.59,.59,.59,1.54,0,2.12l-1.41,1.41c-.29,.29-.68,.44-1.06,.44s-.77-.15-1.06-.44c-.59-.59-.59-1.54,0-2.12l1.41-1.41c.59-.59,1.54-.59,2.12,0ZM3.51,5.64c-.59-.59-.59-1.54,0-2.12,.59-.59,1.54-.59,2.12,0l1.41,1.41c.59,.59,.59,1.54,0,2.12-.29,.29-.68,.44-1.06,.44s-.77-.15-1.06-.44l-1.41-1.41Zm16.97,12.73c.59,.59,.59,1.54,0,2.12-.29,.29-.68,.44-1.06,.44s-.77-.15-1.06-.44l-1.41-1.41c-.59-.59-.59-1.54,0-2.12,.59-.59,1.54-.59,2.12,0l1.41,1.41Zm3.51-6.36c0,.83-.67,1.5-1.5,1.5h-2c-.83,0-1.5-.67-1.5-1.5s.67-1.5,1.5-1.5h2c.83,0,1.5,.67,1.5,1.5ZM3.5,13.5H1.5c-.83,0-1.5-.67-1.5-1.5s.67-1.5,1.5-1.5H3.5c.83,0,1.5,.67,1.5,1.5s-.67,1.5-1.5,1.5ZM10.5,3.5V1.5c0-.83,.67-1.5,1.5-1.5s1.5,.67,1.5,1.5V3.5c0,.83-.67,1.5-1.5,1.5s-1.5-.67-1.5-1.5Zm3,17v2c0,.83-.67,1.5-1.5,1.5s-1.5-.67-1.5-1.5v-2c0-.83,.67-1.5-1.5-1.5s1.5,.67,1.5,1.5Z"/>':'<path d="M15,24a12.021,12.021,0,0,1-8.914-3.966,11.9,11.9,0,0,1-3.02-9.309A12.122,12.122,0,0,1,13.085.152a13.061,13.061,0,0,1,5.031.205,2.5,2.5,0,0,1,1.108,4.226c-4.56,4.166-4.164,10.644.807,14.41a2.5,2.5,0,0,1-.7,4.32A13.894,13.894,0,0,1,15,24Z"/>',localStorage.setItem("tvTheme",t)}i(t),n&&n.addEventListener("click",()=>{i("dark"===document.documentElement.getAttribute("data-theme")?"light":"dark")})}(),function(){const t=localStorage.getItem("tvLanguage")||"en",n=document.getElementById("tvLanguageToggle"),i=document.getElementById("tvLangCode");function s(t){o=t,localStorage.setItem("tvLanguage",t),i&&(i.textContent=t.toUpperCase()),e&&l(e)}s(t),n&&n.addEventListener("click",()=>{s("en"===o?"pl":"en")})}(),u()}),window.addEventListener("beforeunload",()=>{i&&(clearInterval(i),i=null)});
